<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portal de Documentos</title>

  <style>
    :root{
      --blue:#003087;
      --dark:#0b1f4a;

      --bg: radial-gradient(1200px 700px at 20% -10%, rgba(77,163,255,.18), transparent 55%),
            radial-gradient(900px 600px at 90% 10%, rgba(77,163,255,.12), transparent 55%),
            linear-gradient(180deg, #050a14, #071022);

      --txt:#eaf1ff;
      --muted:rgba(234,241,255,.70);
      --line:rgba(234,241,255,.10);

      --shadow: 0 16px 60px rgba(0,0,0,.45);
      --radius:18px;

      --btnBlue: rgba(77,163,255,.18);
      --btnBlueLine: rgba(77,163,255,.35);

      --waBg: rgba(34,197,94,.18);
      --waLine: rgba(34,197,94,.35);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--txt);
      background: var(--bg);
    }

    header{
      position:sticky; top:0; z-index:20;
      background: rgba(7,16,34,.82);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--line);
    }

    .wrap{max-width:1100px;margin:0 auto;padding:16px}

    /* Top */
    .top{
      display:flex; gap:12px; align-items:center;
      padding:14px 16px 10px;
    }
    .brand{display:flex;gap:10px;align-items:center}
    .logo{
      width:42px;height:42px;border-radius:16px;display:grid;place-items:center;
      background:rgba(77,163,255,.14);
      border:1px solid rgba(77,163,255,.22);
      font-size:18px;
      flex:0 0 auto;
    }
    h1{margin:0;font-size:18px;letter-spacing:.2px}

    /* Search */
    .controls{padding:0 16px 12px}
    input{
      width:100%;
      appearance:none;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--txt);
      padding:12px 14px;
      border-radius:14px;
      outline:none;
    }
    input::placeholder{color:rgba(234,241,255,.55)}

    /* Tabs */
    .tabs{display:flex;gap:8px;padding:0 16px 14px;flex-wrap:wrap}
    .tab{
      border:1px solid var(--line);
      background:rgba(255,255,255,.05);
      color:var(--txt);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:800;
      font-size:13px;
      user-select:none;
    }
    .tab.active{
      background:rgba(77,163,255,.18);
      border-color:rgba(77,163,255,.35);
    }

    /* Scroll area */
    main.wrap{
      height:calc(100vh - 160px);
      overflow:auto;
      padding-top:14px;
    }

    /* Sections (PDF tabs) */
    .section{
      margin: 0 0 18px;
      padding: 14px;
      border:1px solid var(--line);
      background:rgba(13,26,51,.55);
      border-radius: var(--radius);
      box-shadow: 0 10px 35px rgba(0,0,0,.18);
    }
    .section-head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      padding-bottom:12px;
      border-bottom:1px solid var(--line);
      margin-bottom:14px;
    }
    .section h2{margin:0;font-size:16px;letter-spacing:.2px}
    .count{color:var(--muted);font-size:12px;white-space:nowrap}

    /* Cards (PDF list) */
    .grid{
      display:grid;
      grid-template-columns:repeat(12,1fr);
      gap:12px;
    }
    .card{
      grid-column:span 12;
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    @media (min-width:760px){ .card{grid-column:span 6} }
    @media (min-width:1050px){ .card{grid-column:span 4} }

    .icon{
      width:42px;height:42px;border-radius:16px;display:grid;place-items:center;
      background:rgba(77,163,255,.14);
      border:1px solid rgba(77,163,255,.22);
      font-size:18px;flex:0 0 auto
    }
    .meta{flex:1;min-width:0}
    .title{
      margin:0 0 6px;
      font-weight:900;
      line-height:1.25;
      font-size:14px;
      word-break:break-word;
    }
    .muted{margin:0;color:var(--muted);font-size:12px}

    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .btn{
      display:inline-flex; gap:8px; align-items:center; justify-content:center;
      text-decoration:none;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--btnBlueLine);
      background:var(--btnBlue);
      color:var(--txt);
      font-weight:900;
      cursor:pointer;
      user-select:none;
      min-width: 132px;
    }
    .btn.secondary{
      border-color: var(--line);
      background: rgba(255,255,255,.06);
      font-weight:800;
      min-width:auto;
    }
    .btn:active{transform:translateY(1px)}

    footer{
      padding:12px 16px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
      border-top:1px solid var(--line);
    }

    /* ===== PDF Modal ===== */
    .overlay{
      position:fixed; inset:0; z-index:200;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.55);
      padding: 14px;
    }
    .modal{
      width:min(1100px, 100%);
      height:min(86vh, 860px);
      background: rgba(14,24,45,.96);
      border:1px solid var(--line);
      border-radius: 18px;
      overflow:hidden;
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
    }
    .modal-head{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    .modal-title{
      font-weight:900;
      font-size:13px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .modal-body{flex:1; background:#0b1220}
    .modal-body iframe{width:100%;height:100%;border:0;background:#0b1220}

    /* ===== Contato Modal (estilo do seu HTML) ===== */
    .contact-overlay{
      position:fixed; inset:0; z-index:220;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.55);
      padding: 14px;
    }
    .contact-modal{
      width:min(720px, 100%);
      background:#f3f6fb;
      color:#0b1220;
      border-radius: 16px;
      overflow:hidden;
      box-shadow: var(--shadow);
    }
    .contact-modal .h{
      padding:14px 16px;
      background:#e8eef7;
      font-weight:950;
      font-size:16px;
      border-bottom:1px solid rgba(0,0,0,.08);
    }
    .contact-modal .b{
      padding:14px 16px;
      font-size:14px;
      line-height:1.45;
    }
    .contact-modal .f{
      padding:14px 16px;
      border-top:1px solid rgba(0,0,0,.08);
    }
    .contact-modal .f .btn{
      width:100%;
      background:#0b3b8f;
      border-color:#0b3b8f;
      color:#fff;
      font-weight:950;
    }

    /* ===== CANAIS (layout igual ao original) ===== */
    .canais-wrap{max-width:1100px;margin:0 auto;padding:6px 0 10px;}
    .canais-hero{text-align:center;padding: 10px 10px 18px;}
    .canais-logo{display:flex;justify-content:center;align-items:center;margin-top: 6px;}
    .canais-title{margin:12px 0 6px;font-size: 22px;font-weight: 900;}
    .canais-subtitle{margin:0;font-size: 14px;color: var(--muted);}

    .canais-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
      padding: 6px 8px 18px;
    }
    @media (min-width: 760px){ .canais-grid{ grid-template-columns: 1fr 1fr; } }
    @media (min-width: 1050px){ .canais-grid{ grid-template-columns: 1fr 1fr 1fr; } }

    .canais-card{
      background:#fff;
      color:#0b1220;
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 16px 40px rgba(0,0,0,.28);
      border: 1px solid rgba(0,0,0,.06);
    }
    .canais-card h3{margin:0 0 10px;font-size: 20px;font-weight: 950;}
    .canais-card p{
      margin: 6px 0;
      font-size: 14px;
      line-height: 1.35;
      color: rgba(11,18,32,.78);
    }
    .canais-actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 14px;
    }
    .canais-btn{
      border:0;
      border-radius: 12px;
      padding: 12px 12px;
      font-weight: 950;
      cursor: pointer;
      text-decoration:none;
      text-align:center;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .canais-btn.wa{ background:#22c55e; color:#fff; }
    .canais-btn.info{ background:#0b3b8f; color:#fff; }
    .hidden{display:none !important;}
  </style>
</head>

<body>
<header>
  <div class="top">
    <div class="brand">
      <div class="logo">üìÅ</div>
      <div>
        <h1>Portal de Documentos</h1>
      </div>
    </div>
  </div>

  <div class="controls">
    <input id="q" placeholder="Buscar por nome..." />
  </div>

  <div class="tabs">
    <button class="tab active" data-tab="ordens">Ordens de Servi√ßo</button>
    <button class="tab" data-tab="boletins">Boletins</button>
    <button class="tab" data-tab="canais">Canais</button>
  </div>
</header>

<main class="wrap">
  <div id="content"></div>
</main>

<footer>
  Para adicionar PDFs: envie para as pastas do reposit√≥rio (o site atualiza sozinho).
</footer>

<!-- PDF VIEWER MODAL -->
<div id="pdfOverlay" class="overlay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-title" id="pdfTitle">Visualizar PDF</div>
      <button class="btn secondary" onclick="closePdf()">Fechar</button>
    </div>
    <div class="modal-body">
      <iframe id="pdfFrame" title="Visualizador de PDF"></iframe>
    </div>
  </div>
</div>

<!-- CONTATO MODAL -->
<div id="modalOverlay" class="contact-overlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="contact-modal">
    <div class="h"><span id="modalTitle">Informa√ß√µes de Contato</span></div>
    <div class="b"><div id="modalContent"></div></div>
    <div class="f"><button class="btn" onclick="closeModal()">Fechar</button></div>
  </div>
</div>

<script>
/** ====== CONFIG DO SEU REPO ====== */
const OWNER  = "danielzavalhia-commits";
const REPO   = "dani2";
const BRANCH = "main";

/** Pastas que o portal lista automaticamente (PDFs dentro delas e subpastas) */
const SECTIONS = {
  ordens: [
    { label: "Ordens de Servi√ßo", root: "ordens_servico" }
  ],
  boletins: [
    { label: "Boletins T√©cnicos", root: "boletins/tecnicos" },
    { label: "Boletins M√£o de Obra", root: "boletins/mao_de_obra" }
  ]
};

/** ====== ABA CANAIS (dados) ====== */
const CANAIS = [
  { nome:"Tha√≠s", funcao:"Atendimento ‚Äì Abertura de OS (Manuten√ß√£o)", email:"atendimentocozinhas.far@tramontina.com", tel:"+55 (54) 98153-6033", wa:"https://wa.me/5554981536033" },
  { nome:"Adalberto", funcao:"Suporte T√©cnico ‚Äì OS (Manuten√ß√£o)", email:"adalberto.souto@tramontina.com", tel:"+55 (54) 99243-7971", wa:"https://wa.me/5554992437971" },
  { nome:"Patr√≠cia", funcao:"Atendimento ‚Äì OS (Instala√ß√£o)", email:"atendimentocozinhas.far@tramontina.com", tel:"+55 (54) 99140-5949", wa:"https://wa.me/5554991405949" },
  { nome:"Mauricio", funcao:"Suporte T√©cnico ‚Äì OS (Instala√ß√£o)", email:"mauricio.lima@tramontina.com", tel:"+55 (54) 99205-7821", wa:"https://wa.me/5554992057821" },
  { nome:"Lucas", funcao:"Promotor T√©cnico ‚Äì Regi√µes Sudeste e Nordeste", email:"lucas.bin@tramontina.com", tel:"+55 (54) 98153-6011", wa:"https://wa.me/5554981536011" },
  { nome:"Rafael", funcao:"Promotor T√©cnico ‚Äì Regi√µes Sul, Centro-Oeste e Norte", email:"rafael.silva@tramontina.com", tel:"+55 (54) 99101-2025", wa:"https://wa.me/5554991012025" },
  { nome:"Robson", funcao:"Suporte T√©cnico ‚Äì S√£o Paulo (SP)", email:"robson.menezes@tramontina.com", tel:"+55 (11) 96171-8289", wa:"https://wa.me/5511961718289" },
  { nome:"Josu√©", funcao:"Promotor T√©cnico ‚Äì S√£o Paulo (SP)", email:"josue.rocha@tramontina.com", tel:"+55 (11) 91499-5839", wa:"https://wa.me/5511914995839" }
];

/** ====== UI ====== */
const content = document.getElementById("content");
const tabs = [...document.querySelectorAll(".tab")];
const q = document.getElementById("q");
let activeTab = "ordens";

/** ====== Helpers ====== */
function isPdf(path){ return path.toLowerCase().endsWith(".pdf"); }
function startsWithFolder(filePath, folderRoot){
  const a = filePath.replace(/^\/+/,"");
  const b = folderRoot.replace(/^\/+/,"").replace(/\/+$/,"");
  return a === b || a.startsWith(b + "/");
}
function prettify(path){
  const name = path.split("/").pop() || path;
  const base = name.replace(/\.[^/.]+$/, "");
  return base
    .replace(/[_-]+/g," ")
    .replace(/\s+/g," ")
    .trim()
    .replace(/\b\w/g, c=>c.toUpperCase());
}
function pageHrefFor(filePath){
  return new URL(filePath.replace(/^\/+/,""), window.location.href).href;
}

/** ====== Tree cache ====== */
let TREE = null;

async function getBranchSha(){
  const url = `https://api.github.com/repos/${OWNER}/${REPO}/branches/${BRANCH}`;
  const res = await fetch(url, { headers: { "Accept":"application/vnd.github+json" }});
  if(!res.ok) throw new Error(`N√£o consegui ler a branch ${BRANCH} (HTTP ${res.status}).`);
  const data = await res.json();
  return data?.commit?.sha;
}

async function getRepoTree(){
  if(TREE) return TREE;
  const sha = await getBranchSha();
  const url = `https://api.github.com/repos/${OWNER}/${REPO}/git/trees/${sha}?recursive=1`;
  const res = await fetch(url, { headers: { "Accept":"application/vnd.github+json" }});
  if(!res.ok) throw new Error(`N√£o consegui listar os arquivos (HTTP ${res.status}).`);
  const data = await res.json();
  TREE = (data.tree || [])
    .filter(x => x.type === "blob")
    .map(x => x.path)
    .filter(isPdf);
  return TREE;
}

/** ====== PDF modal ====== */
function openPdf(title, url){
  document.getElementById("pdfTitle").textContent = title;
  document.getElementById("pdfFrame").src = url + "#view=FitH";
  document.getElementById("pdfOverlay").style.display = "flex";
}
function closePdf(){
  document.getElementById("pdfOverlay").style.display = "none";
  document.getElementById("pdfFrame").src = "about:blank";
}
document.getElementById("pdfOverlay").addEventListener("click", (e)=>{
  if(e.target.id === "pdfOverlay") closePdf();
});

/** ====== Contato modal ====== */
function showContact(name, role, email, phone) {
  document.getElementById('modalContent').innerHTML =
    '<b>Nome:</b> ' + name +
    '<br><b>Fun√ß√£o:</b> ' + role +
    '<br><b>E-mail:</b> ' + email +
    '<br><b>Telefone:</b> ' + phone;

  document.getElementById('modalOverlay').style.display = 'flex';
}
function closeModal() {
  document.getElementById('modalOverlay').style.display = 'none';
}
document.getElementById("modalOverlay").addEventListener("click", (e)=>{
  if(e.target.id === "modalOverlay") closeModal();
});
document.addEventListener("keydown", (e)=>{
  if(e.key === "Escape"){
    closePdf();
    closeModal();
  }
});

/** ====== Render pieces ====== */
function sectionShell(title, countText, innerHtml){
  return `
    <section class="section">
      <div class="section-head">
        <h2>${title}</h2>
        <div class="count">${countText || ""}</div>
      </div>
      ${innerHtml}
    </section>
  `;
}

function pdfCard(filePath){
  const title = prettify(filePath);
  const url = pageHrefFor(filePath);
  return `
    <div class="card">
      <div class="icon">üìÑ</div>
      <div class="meta">
        <p class="title">${title}</p>
        <p class="muted">PDF</p>
        <div class="actions">
          <button class="btn" onclick="${`openPdf(${JSON.stringify(title)}, ${JSON.stringify(url)})`}">Visualizar</button>
          <a class="btn secondary" href="${url}" target="_blank" rel="noopener">Nova guia</a>
        </div>
      </div>
    </div>
  `;
}

function tramontinaLogoSvg(){
  // ‚Äúdesenho‚Äù simples em SVG (n√£o √© a logo oficial, mas fica muito parecido visualmente)
  return `
  <svg width="520" height="90" viewBox="0 0 520 90" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Tramontina">
    <defs>
      <linearGradient id="g" x1="0" x2="1">
        <stop offset="0" stop-color="rgba(255,255,255,.92)"/>
        <stop offset="1" stop-color="rgba(255,255,255,.78)"/>
      </linearGradient>
    </defs>

    <!-- s√≠mbolo "T" estilizado (gen√©rico) -->
    <path d="M55 18
             C40 18 33 25 33 38
             L33 42
             L63 42
             L63 68
             C63 76 57 82 49 82
             L44 82
             L44 42
             L16 42
             L16 38
             C16 15 31 6 55 6
             L90 6
             L90 18
             Z"
          fill="url(#g)" opacity="0.95"/>

    <!-- texto TRAMONTINA -->
    <text x="112" y="60"
          font-family="Arial, system-ui, -apple-system, Segoe UI, Roboto, sans-serif"
          font-size="44"
          font-weight="900"
          letter-spacing="2"
          fill="url(#g)">TRAMONTINA</text>
  </svg>`;
}

function canaisHtml(filtered){
  return `
    <div class="canais-wrap">
      <div class="canais-hero">
        <div class="canais-logo">${tramontinaLogoSvg()}</div>
        <div class="canais-title">Canais de Atendimento ‚Äì Tramontina Profissional | Farroupilha</div>
        <div class="canais-subtitle">Ordens de Servi√ßo ‚Ä¢ Suporte T√©cnico ‚Ä¢ Promotores T√©cnicos</div>
      </div>

      <div class="canais-grid">
        ${filtered.map(c => `
          <div class="canais-card">
            <h3>${c.nome}</h3>
            <p>${c.funcao}</p>
            <p><b>E-mail:</b> ${c.email}</p>
            <div class="canais-actions">
              <a class="canais-btn wa" target="_blank" rel="noopener" href="${c.wa}">WhatsApp</a>
              <button class="canais-btn info"
                onclick="showContact(${JSON.stringify(c.nome)}, ${JSON.stringify(c.funcao)}, ${JSON.stringify(c.email)}, ${JSON.stringify(c.tel)})">
                Mostrar contato
              </button>
            </div>
          </div>
        `).join("")}
      </div>
    </div>
  `;
}

/** ====== Main render ====== */
async function render(){
  const query = (q.value || "").trim().toLowerCase();

  // CANAIS
  if(activeTab === "canais"){
    const filtered = CANAIS.filter(c => {
      if(!query) return true;
      return (c.nome + " " + c.funcao + " " + c.email).toLowerCase().includes(query);
    });
    content.innerHTML = canaisHtml(filtered);
    return;
  }

  // PDFs
  let allPdfs = [];
  try{
    allPdfs = await getRepoTree();
  }catch(e){
    content.innerHTML = sectionShell("Erro", "", `<p class="muted">${e.message || String(e)}</p>`);
    return;
  }

  const sections = SECTIONS[activeTab] || [];
  let html = "";

  for(const sec of sections){
    const root = sec.root.replace(/\/+$/,"");
    let files = allPdfs.filter(p => startsWithFolder(p, root));
    if(query) files = files.filter(p => p.toLowerCase().includes(query));
    files.sort((a,b)=>a.localeCompare(b,"pt-BR"));

    const cards = files.length
      ? `<div class="grid">${files.map(pdfCard).join("")}</div>`
      : `<p class="muted">Nenhum PDF encontrado nesta se√ß√£o.</p>`;

    html += sectionShell(sec.label, `${files.length} arquivo(s)`, cards);
  }

  content.innerHTML = html || sectionShell("Sem conte√∫do", "", `<p class="muted">Nada para mostrar.</p>`);
}

/** Tabs */
tabs.forEach(t=>{
  t.addEventListener("click", ()=>{
    tabs.forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    activeTab = t.dataset.tab;
    render();
  });
});

/** Busca */
q.addEventListener("input", ()=>render());

render();
</script>
</body>
</html>
